<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.frog.dao.PostDao">
	<resultMap type="PostVO" id="postResultMap">
    	<id column="board_no" property="index"/>
		<result column="title" property="title"/>
		<result column="contents" property="contents"/>
		<result column="user_id" property="userid"/>
		<result column="register_date" property="register_date" javaType="java.sql.Date"/>
		<result column="modify_date" property="modify_date" javaType="java.sql.Date"/>
		<result column="visible" property="visible"/>
	</resultMap>
 
 	<select id="selectList" resultMap="postResultMap">
		select * from test_board limit #{offset},#{limit}
	</select>
	<select id="selectPost" parameterType="String" resultMap="postResultMap">
		select * from test_board where board_no=#{value}
	</select>
	
	<select id="selectOne" parameterType="int" resultMap="postResultMap">
		select * from test_board where board_no=#{value}
	</select>
	
	<select id="count" resultType="int">
		select count(*) from test_board
	</select>
	
	<select id="finalRow" resultType="int">
		select board_no from test_board order by board_no desc limit 1
	</select>
	
	<insert id="insert" parameterType="PostVO" useGeneratedKeys="true" keyProperty="index">
		insert into test_board(title,contents,user_id,register_date,modify_date,visible)
		values (#{title},#{contents},#{userid},now(),now(),1)

     
	</insert>


  
  	<delete id="delete">
  		delete from test_board where board_no=#{index}
  	</delete>
  	
  	<insert id="update" parameterType="PostVO">
  	 update test_board set title=#{title}, contents=#{contents}, modify_date=now() where board_no=#{index} 
  	 </insert>
  		
  	<insert id="insertFile" parameterType="hashmap">
        INSERT INTO TB_FILE
        (  
            BOARD_IDX,
            ORIGINAL_FILE_NAME,
            STORED_FILE_NAME,
            FILE_SIZE,
            CREA_ID,
            CREA_DTM
        )
        VALUES
        (
            #{BOARD_IDX},
            #{ORIGINAL_FILE_NAME},
            #{STORED_FILE_NAME},
            #{FILE_SIZE},
            'Admin',
            now()
        )
</insert>	
</mapper>